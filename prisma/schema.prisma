generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 String       @id @default(uuid())
  email              String       @unique
  name               String?
  phone              String?
  primaryGutIssue    String?
  medicalHistory     String?
  allergies          String?
  currentMedications String?
  dietType           String?
  logs               HealthLog[]
  conversations      Conversation[]
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @updatedAt
}

model HealthLog {
  id               String   @id @default(uuid())
  user             User     @relation(fields: [userId], references: [id])
  userId           String
  date             DateTime
  bloating         Int
  constipation     Int
  acidity          Int
  stressLevel      Int
  sleepHours       Float
  mealQuality      Int
  stoolType        Int
  waterIntake      Float
  exerciseMinutes  Int
  gutScore         Int
  createdAt        DateTime @default(now())
}

model Conversation {
  id             String     @id @default(uuid())
  user           User       @relation(fields: [userId], references: [id])
  userId         String
  title          String?
  topic          String?
  messages       Message[]
  gutScoreStart  Int?
  gutScoreEnd    Int?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
}

model Message {
  id             String       @id @default(uuid())
  conversation   Conversation @relation(fields: [conversationId], references: [id])
  conversationId String
  role           String
  content        String
  intent         String?
  recommendedProduct String?
  sentiment      String?
  createdAt      DateTime   @default(now())
}

